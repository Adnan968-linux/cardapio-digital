<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NOSSO CLUBE - Card√°pio Digital</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800;900&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        :root {
            --marrom: #8B4513;
            --marrom-claro: #D2B48C;
            --preto: #000;
            --branco: #fff;
            --cinza: #faf7f2;
            --sombra: 0 12px 0 #d0d0d0;
            --sombra-hover: 0 18px 0 #a0a0a0;
        }

        body {
            background: var(--cinza);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1300px;
            margin: 0 auto;
            background: white;
            border-radius: 48px;
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);
            overflow: hidden;
            border: 1px solid rgba(139,69,19,0.1);
        }

        /* HEADER */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 30px 40px;
            background: linear-gradient(145deg, #0a0a0a, var(--preto));
            border-bottom: 3px solid var(--marrom);
        }

        .logo-area {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .soda-icon {
            font-size: 56px;
            animation: girar 10s infinite linear;
            filter: drop-shadow(0 0 10px var(--marrom));
        }

        @keyframes girar {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        h1 {
            font-size: 3.2rem;
            font-weight: 900;
            font-family: 'Playfair Display', serif;
            background: linear-gradient(135deg, #fff, #f5e6d3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 3px 3px 0 var(--marrom);
            letter-spacing: 2px;
        }

        .admin-btn {
            background: var(--marrom);
            color: white;
            border: 2px solid var(--marrom-claro);
            padding: 14px 35px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s;
            box-shadow: 0 5px 0 #4a2c1a;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 0 #4a2c1a;
            background: #9c5a2a;
        }

        /* CATEGORIAS */
        .categorias {
            background: white;
            padding: 25px 40px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            border-bottom: 1px solid #eee;
        }

        .categoria-btn {
            background: white;
            border: 2px solid var(--marrom);
            padding: 12px 28px;
            border-radius: 40px;
            font-weight: 600;
            color: #333;
            cursor: pointer;
            transition: 0.3s;
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .categoria-btn.ativo {
            background: var(--marrom);
            color: white;
            border-color: var(--marrom-claro);
            box-shadow: 0 4px 0 #4a2c1a;
        }

        .categoria-btn:hover {
            background: var(--marrom);
            color: white;
            transform: translateY(-2px);
        }

        /* CARD√ÅPIO - COM FOTOS REDONDAS */
        .cardapio {
            background: white;
            padding: 40px;
            min-height: 400px;
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 30px;
        }

        .item-card {
            background: white;
            border: 2px solid var(--marrom);
            border-radius: 40px;
            overflow: hidden;
            transition: 0.4s;
            position: relative;
            box-shadow: var(--sombra);
            display: flex;
            flex-direction: column;
        }

        .item-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--sombra-hover);
        }

        /* FOTO REDONDA */
        .foto-container {
            padding: 25px 25px 0 25px;
            display: flex;
            justify-content: center;
        }

        .item-foto {
            width: 180px;
            height: 180px;
            border-radius: 50%; /* BORDA REDONDA */
            object-fit: cover;
            border: 4px solid var(--marrom);
            box-shadow: 0 8px 0 #d0d0d0;
            transition: 0.3s;
            background: #f8f8f8;
        }

        .item-card:hover .item-foto {
            transform: scale(1.05);
            border-color: var(--marrom-claro);
        }

        .sem-foto {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
            border: 4px solid var(--marrom);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--marrom);
            font-size: 3rem;
            margin: 0 auto;
            box-shadow: 0 8px 0 #d0d0d0;
        }

        .item-content {
            padding: 20px 25px 25px;
            text-align: center;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .item-nome {
            font-size: 1.4rem;
            font-weight: 700;
            color: #2d2d2d;
        }

        .item-preco {
            background: var(--marrom);
            color: white;
            padding: 8px 18px;
            border-radius: 30px;
            font-weight: 800;
            font-size: 1.2rem;
            border: 2px solid var(--marrom-claro);
        }

        .item-descricao {
            color: #666;
            line-height: 1.6;
            font-size: 0.95rem;
            margin-bottom: 15px;
            text-align: left;
        }

        .item-badge {
            display: inline-block;
            background: #f0f0f0;
            padding: 6px 18px;
            border-radius: 30px;
            border: 1px solid var(--marrom);
            font-size: 0.8rem;
            font-weight: 600;
            color: #4a4a4a;
        }

        .destaque-badge {
            position: absolute;
            top: -12px;
            right: 20px;
            background: var(--marrom);
            color: white;
            padding: 8px 24px;
            border-radius: 30px;
            border: 2px solid var(--marrom-claro);
            font-weight: 700;
            font-size: 0.9rem;
            box-shadow: 0 4px 0 #4a2c1a;
            z-index: 10;
        }

        /* LOADING */
        .loading {
            text-align: center;
            padding: 80px;
            background: white;
        }

        .spinner {
            font-size: 60px;
            margin-bottom: 20px;
            animation: girar 2s infinite linear;
        }

        /* EMPTY */
        .empty-message {
            text-align: center;
            padding: 80px 20px;
            background: white;
            border-radius: 30px;
            border: 2px solid var(--marrom);
        }

        .empty-message h2 {
            font-size: 2.5rem;
            color: var(--marrom);
            margin-bottom: 20px;
        }

        /* FOOTER */
        .footer {
            background: white;
            border-radius: 0 0 48px 48px;
            padding: 30px;
            text-align: center;
            border-top: 1px solid var(--marrom);
        }

        .footer p {
            color: #666;
        }

        .footer strong {
            color: var(--marrom);
        }

        /* MODAL */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            padding: 50px;
            border-radius: 50px;
            max-width: 450px;
            width: 90%;
            text-align: center;
            border: 2px solid var(--marrom);
            box-shadow: 0 20px 0 #4a2c1a;
        }

        .modal-content h2 {
            color: var(--marrom);
            font-size: 2.2rem;
            margin: 20px 0;
        }

        .modal-content input {
            width: 100%;
            padding: 18px 25px;
            margin: 10px 0;
            border: 2px solid var(--marrom);
            border-radius: 50px;
            font-size: 1rem;
            transition: 0.3s;
        }

        .modal-content input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(139,69,19,0.3);
        }

        .modal-btn {
            background: var(--marrom);
            color: white;
            border: none;
            padding: 18px 30px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            border: 2px solid var(--marrom-claro);
            box-shadow: 0 5px 0 #4a2c1a;
            transition: 0.3s;
        }

        .modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 0 #4a2c1a;
        }

        .modal-close {
            margin-top: 20px;
            color: #999;
            cursor: pointer;
            background: none;
            border: none;
            font-size: 1rem;
        }

        /* ADMIN PANEL */
        .admin-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--cinza);
            overflow-y: auto;
            padding: 30px;
            display: none;
            z-index: 2000;
        }

        .admin-content {
            max-width: 1300px;
            margin: 0 auto;
            background: white;
            border-radius: 40px;
            padding: 35px;
            border: 2px solid var(--marrom);
            box-shadow: 0 15px 0 #4a2c1a;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid var(--marrom);
        }

        .admin-header h2 {
            color: var(--marrom);
            font-size: 2.2rem;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--marrom);
            color: white;
            padding: 25px;
            border-radius: 30px;
            text-align: center;
            border: 2px solid var(--marrom-claro);
            box-shadow: 0 5px 0 #4a2c1a;
        }

        .stat-card h3 {
            font-size: 1rem;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
        }

        .form-section {
            background: #f9f9f9;
            padding: 30px;
            border-radius: 30px;
            margin-bottom: 30px;
            border: 2px solid var(--marrom);
        }

        .form-section h3 {
            color: var(--marrom);
            margin-bottom: 25px;
            font-size: 1.5rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-control {
            width: 100%;
            padding: 14px 20px;
            border: 2px solid var(--marrom);
            border-radius: 30px;
            font-size: 1rem;
            transition: 0.3s;
        }

        .form-control:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(139,69,19,0.2);
        }

        /* UPLOAD AREA */
        .upload-area {
            border: 3px dashed var(--marrom);
            border-radius: 30px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: 0.3s;
            margin-bottom: 20px;
            background: white;
        }

        .upload-area:hover {
            background: #f0f0f0;
            border-color: #5c3e2a;
        }

        .upload-icon {
            font-size: 48px;
            color: var(--marrom);
            margin-bottom: 10px;
        }

        .upload-info {
            color: #666;
            font-size: 0.9rem;
        }

        /* PREVIEW DA FOTO */
        .preview-container {
            position: relative;
            display: inline-block;
            margin: 20px auto;
        }

        .preview-img {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--marrom);
            box-shadow: 0 5px 0 #4a2c1a;
        }

        .remove-preview {
            position: absolute;
            top: -10px;
            right: -10px;
            background: #dc3545;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 2px solid white;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn {
            background: var(--marrom);
            color: white;
            border: 2px solid var(--marrom-claro);
            padding: 14px 30px;
            border-radius: 40px;
            font-weight: 700;
            cursor: pointer;
            transition: 0.3s;
            box-shadow: 0 4px 0 #4a2c1a;
            font-size: 1rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 0 #4a2c1a;
        }

        .btn-danger {
            background: #dc3545;
            border-color: #ff9e9e;
        }

        .btn-secondary {
            background: #666;
            border-color: #999;
        }

        .admin-items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .admin-item {
            background: white;
            border: 2px solid var(--marrom);
            border-radius: 25px;
            padding: 20px;
            transition: 0.3s;
        }

        .admin-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 0 #d0d0d0;
        }

        .admin-item-foto {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--marrom);
            margin: 0 auto 15px;
            display: block;
        }

        .filtros {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .filtro-btn {
            background: #f0f0f0;
            border: 2px solid var(--marrom);
            padding: 12px 25px;
            border-radius: 40px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.3s;
        }

        .filtro-btn.ativo {
            background: var(--marrom);
            color: white;
        }

        @media (max-width: 768px) {
            .header { flex-direction: column; padding: 20px; }
            .logo-area { flex-direction: column; }
            h1 { font-size: 2.2rem; }
            .stats-container { grid-template-columns: 1fr; }
            .form-grid { grid-template-columns: 1fr; }
            .item-foto { width: 140px; height: 140px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <div class="logo-area">
                <span class="soda-icon">ü•§</span>
                <h1>NOSSO CLUBE</h1>
            </div>
            <button class="admin-btn" onclick="abrirModalLogin()">
                <span>‚öôÔ∏è</span> ADMIN
            </button>
        </div>

        <!-- CATEGORIAS -->
        <div class="categorias" id="categorias"></div>

        <!-- CARD√ÅPIO -->
        <div class="cardapio">
            <div id="loading" class="loading">
                <div class="spinner">ü•§</div>
                <p style="color: var(--marrom);">Carregando card√°pio...</p>
            </div>

            <div id="cardapioContainer"></div>

            <div id="emptyMessage" class="empty-message" style="display: none;">
                <h2>üçΩÔ∏è CARD√ÅPIO VAZIO</h2>
                <p style="margin: 20px 0; color: #666;">Nenhum item cadastrado ainda.</p>
                <button onclick="abrirModalLogin()" class="admin-btn">ADICIONAR ITENS</button>
            </div>
        </div>

        <!-- FOOTER -->
        <div class="footer">
            <p style="font-size: 1.2rem; font-weight: 700; color: var(--marrom);">
                ü•§ CARD√ÅPIO DIGITAL NOSSO CLUBE ü•§
            </p>
            <p style="margin-top: 10px;">Atendimento: 12h √†s 23h ‚Ä¢ Atualiza√ß√£o em tempo real</p>
            <p style="margin-top: 5px; color: var(--marrom);">‚ö° Com fotos dos alimentos! ‚ö°</p>
        </div>
    </div>

    <!-- MODAL DE LOGIN -->
    <div id="modalLogin" class="modal">
        <div class="modal-content">
            <span style="font-size: 70px;">ü•§</span>
            <h2>√ÅREA ADMIN</h2>
            
            <input type="text" id="loginUsuario" placeholder="Usu√°rio" value="admin">
            <input type="password" id="loginSenha" placeholder="Senha" value="admin123">
            
            <div id="loginErro" style="color: #dc3545; margin: 10px 0; font-weight: 600; display: none;">
                ‚ö†Ô∏è Usu√°rio ou senha incorretos!
            </div>
            
            <button class="modal-btn" onclick="fazerLogin()">
                ENTRAR NO PAINEL
            </button>
            
            <button class="modal-close" onclick="fecharModal()">
                Fechar
            </button>
        </div>
    </div>

    <!-- PAINEL ADMIN -->
    <div id="adminPanel" class="admin-panel">
        <div class="admin-content">
            <!-- HEADER ADMIN -->
            <div class="admin-header">
                <h2>üë®‚Äçüíº PAINEL ADMINISTRATIVO</h2>
                <div>
                    <button onclick="fecharAdmin()" class="btn btn-secondary" style="margin-right: 10px;">
                        VER CARD√ÅPIO
                    </button>
                    <button onclick="logout()" class="btn">
                        SAIR
                    </button>
                </div>
            </div>

            <!-- ESTAT√çSTICAS -->
            <div id="statsContainer" class="stats-container">
                <div class="stat-card">
                    <h3>Carregando...</h3>
                </div>
            </div>

            <!-- FORMUL√ÅRIO PARA ADICIONAR COM UPLOAD -->
            <div class="form-section">
                <h3>‚ûï ADICIONAR NOVO ITEM COM FOTO</h3>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>Nome do Item *</label>
                        <input type="text" id="novoNome" class="form-control" placeholder="Ex: Batata Frita">
                    </div>
                    
                    <div class="form-group">
                        <label>Pre√ßo (R$) *</label>
                        <input type="number" id="novoPreco" step="0.01" class="form-control" placeholder="25.90">
                    </div>
                </div>

                <div class="form-group">
                    <label>Categoria *</label>
                    <select id="novaCategoria" class="form-control">
                        <option value="1">Pratos do Dia</option>
                        <option value="2">Pratos Principais</option>
                        <option value="3">Bebidas</option>
                        <option value="4">Sobremesas</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Descri√ß√£o *</label>
                    <textarea id="novaDescricao" rows="3" class="form-control" placeholder="Descreva o item detalhadamente..."></textarea>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label>Badge (opcional)</label>
                        <input type="text" id="novoBadge" class="form-control" placeholder="Ex: ESPECIAL, POR√á√ÉO">
                    </div>
                    
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px;">
                            <input type="checkbox" id="novoDestaque" style="width: 20px; height: 20px;"> 
                            <span style="font-weight: 600;">‚≠ê Destacar item</span>
                        </label>
                    </div>
                </div>

                <!-- √ÅREA DE UPLOAD -->
                <div class="upload-area" onclick="document.getElementById('fotoInput').click()">
                    <div class="upload-icon">üì∏</div>
                    <p style="font-weight: 600; color: var(--marrom);">Clique para fazer upload da foto</p>
                    <p class="upload-info">JPG, PNG ou WEBP ‚Ä¢ M√°x 5MB ‚Ä¢ A imagem ficar√° redonda</p>
                </div>
                
                <input type="file" id="fotoInput" accept="image/*" style="display: none;" onchange="previewFoto(event)">
                
                <!-- PREVIEW DA FOTO -->
                <div id="previewContainer" class="preview-container" style="display: none;">
                    <img id="previewImg" class="preview-img" src="#" alt="Preview">
                    <div class="remove-preview" onclick="removerPreview()">‚úï</div>
                </div>

                <button onclick="adicionarItem()" class="btn" style="width: 100%; padding: 18px; margin-top: 20px;">
                    ‚ûï ADICIONAR ITEM AO CARD√ÅPIO
                </button>
            </div>

            <!-- FILTROS -->
            <h3 style="color: var(--marrom); margin-bottom: 20px;">üìã ITENS CADASTRADOS</h3>
            
            <div class="filtros">
                <button class="filtro-btn ativo" onclick="filtrarAdmin('todos')" id="filtroTodos">TODOS</button>
                <button class="filtro-btn" onclick="filtrarAdmin('1')" id="filtro1">PRATOS DO DIA</button>
                <button class="filtro-btn" onclick="filtrarAdmin('2')" id="filtro2">PRATOS</button>
                <button class="filtro-btn" onclick="filtrarAdmin('3')" id="filtro3">BEBIDAS</button>
                <button class="filtro-btn" onclick="filtrarAdmin('4')" id="filtro4">SOBREMESAS</button>
            </div>

            <!-- LISTA DE ITENS -->
            <div id="adminItensList" class="admin-items-grid"></div>
            
            <!-- LIMPAR CARD√ÅPIO -->
            <div style="margin-top: 40px; text-align: center;">
                <button onclick="limparCardapio()" class="btn btn-danger" style="padding: 15px 50px;">
                    üóëÔ∏è LIMPAR TODO O CARD√ÅPIO
                </button>
                <p style="margin-top: 15px; color: #999; font-size: 0.9rem;">
                    ‚ö†Ô∏è Esta a√ß√£o n√£o pode ser desfeita!
                </p>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // CONFIGURA√á√ïES
        // ============================================
        const API_URL = window.location.origin;
        let cardapioCompleto = [];
        let adminFiltro = 'todos';
        let fotoUploadData = null;
        let fotoUploadNome = null;

        // ============================================
        // CARREGAR CARD√ÅPIO
        // ============================================
        async function carregarCardapio() {
            document.getElementById('loading').style.display = 'block';
            
            try {
                const response = await fetch(`${API_URL}/api/cardapio`);
                const result = await response.json();
                
                if (result.success) {
                    cardapioCompleto = result.data;
                    renderizarCardapio();
                } else {
                    throw new Error(result.message || 'Erro ao carregar');
                }
            } catch (error) {
                console.error('Erro:', error);
                document.getElementById('loading').innerHTML = `
                    <div style="color: #dc3545;">
                        <div style="font-size: 50px; margin-bottom: 20px;">‚ùå</div>
                        <h3>Erro ao carregar card√°pio</h3>
                        <p style="margin-top: 10px;">${error.message}</p>
                        <button onclick="carregarCardapio()" class="admin-btn" style="margin-top: 20px;">
                            TENTAR NOVAMENTE
                        </button>
                    </div>
                `;
            }
        }

        // ============================================
        // RENDERIZAR CARD√ÅPIO COM FOTOS REDONDAS
        // ============================================
        function renderizarCardapio() {
            document.getElementById('loading').style.display = 'none';
            
            // Verificar se tem itens
            let totalItens = 0;
            cardapioCompleto.forEach(cat => {
                totalItens += cat.itens?.length || 0;
            });
            
            if (totalItens === 0) {
                document.getElementById('emptyMessage').style.display = 'block';
                document.getElementById('categorias').innerHTML = '';
                document.getElementById('cardapioContainer').innerHTML = '';
                return;
            }
            
            document.getElementById('emptyMessage').style.display = 'none';
            
            // Renderizar categorias
            let categoriasHtml = '';
            cardapioCompleto.forEach((categoria, index) => {
                if (categoria.itens && categoria.itens.length > 0) {
                    const ativo = index === 0 ? 'ativo' : '';
                    categoriasHtml += `
                        <button class="categoria-btn ${ativo}" onclick="mostrarCategoria(${categoria.id})">
                            ${categoria.nome} (${categoria.itens.length})
                        </button>
                    `;
                }
            });
            document.getElementById('categorias').innerHTML = categoriasHtml;
            
            // Renderizar itens com fotos redondas
            let cardapioHtml = '';
            cardapioCompleto.forEach((categoria, index) => {
                if (categoria.itens && categoria.itens.length > 0) {
                    const display = index === 0 ? 'block' : 'none';
                    cardapioHtml += `<div id="cat-${categoria.id}" style="display: ${display};">`;
                    cardapioHtml += `<div class="menu-grid">`;
                    
                    categoria.itens.forEach(item => {
                        cardapioHtml += `<div class="item-card">`;
                        
                        if (item.destaque) {
                            cardapioHtml += `<div class="destaque-badge">‚≠ê DESTAQUE</div>`;
                        }
                        
                        // FOTO REDONDA
                        cardapioHtml += `<div class="foto-container">`;
                        if (item.foto) {
                            cardapioHtml += `<img src="${item.foto}" alt="${item.nome}" class="item-foto">`;
                        } else {
                            cardapioHtml += `<div class="sem-foto">ü•§</div>`;
                        }
                        cardapioHtml += `</div>`;
                        
                        cardapioHtml += `<div class="item-content">`;
                        cardapioHtml += `<div class="item-header">`;
                        cardapioHtml += `<span class="item-nome">${item.nome}</span>`;
                        cardapioHtml += `<span class="item-preco">R$ ${parseFloat(item.preco).toFixed(2)}</span>`;
                        cardapioHtml += `</div>`;
                        
                        cardapioHtml += `<div class="item-descricao">${item.descricao}</div>`;
                        
                        if (item.badge && !item.destaque) {
                            cardapioHtml += `<span class="item-badge">${item.badge}</span>`;
                        }
                        
                        cardapioHtml += `</div></div>`;
                    });
                    
                    cardapioHtml += `</div></div>`;
                }
            });
            
            document.getElementById('cardapioContainer').innerHTML = cardapioHtml;
        }

        // ============================================
        // MOSTRAR CATEGORIA
        // ============================================
        function mostrarCategoria(id) {
            document.querySelectorAll('.categoria-btn').forEach(btn => btn.classList.remove('ativo'));
            event.target.classList.add('ativo');
            
            document.querySelectorAll('[id^="cat-"]').forEach(div => div.style.display = 'none');
            
            const divCategoria = document.getElementById(`cat-${id}`);
            if (divCategoria) divCategoria.style.display = 'block';
        }

        // ============================================
        // UPLOAD DE FOTO - PREVIEW
        // ============================================
        function previewFoto(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Verificar tamanho
            if (file.size > 5 * 1024 * 1024) {
                alert('‚ùå Arquivo muito grande! M√°ximo 5MB.');
                return;
            }
            
            // Verificar tipo
            if (!file.type.startsWith('image/')) {
                alert('‚ùå Apenas imagens s√£o permitidas!');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('previewImg').src = e.target.result;
                document.getElementById('previewContainer').style.display = 'block';
                
                // Salvar dados da foto
                fotoUploadData = e.target.result;
                fotoUploadNome = file.name;
            };
            reader.readAsDataURL(file);
        }

        function removerPreview() {
            document.getElementById('previewContainer').style.display = 'none';
            document.getElementById('fotoInput').value = '';
            fotoUploadData = null;
            fotoUploadNome = null;
        }

        // ============================================
        // FAZER UPLOAD DA FOTO PARA O SERVIDOR
        // ============================================
        async function fazerUploadFoto(file) {
            const formData = new FormData();
            formData.append('foto', file);
            
            try {
                const response = await fetch(`${API_URL}/api/upload`, {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                return result;
            } catch (error) {
                console.error('Erro no upload:', error);
                return { success: false, message: error.message };
            }
        }

        // ============================================
        // MODAL LOGIN
        // ============================================
        function abrirModalLogin() {
            document.getElementById('modalLogin').style.display = 'flex';
            document.getElementById('loginErro').style.display = 'none';
        }

        function fecharModal() {
            document.getElementById('modalLogin').style.display = 'none';
        }

        async function fazerLogin() {
            const usuario = document.getElementById('loginUsuario').value;
            const senha = document.getElementById('loginSenha').value;
            
            const loginBtn = event.target;
            loginBtn.disabled = true;
            loginBtn.innerHTML = '‚è≥ ENTRANDO...';
            
            try {
                const response = await fetch(`${API_URL}/api/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ usuario, senha })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    fecharModal();
                    abrirAdmin();
                } else {
                    document.getElementById('loginErro').style.display = 'block';
                }
            } catch (error) {
                console.error('Erro no login:', error);
                alert('Erro ao conectar com o servidor: ' + error.message);
            } finally {
                loginBtn.disabled = false;
                loginBtn.innerHTML = 'ENTRAR NO PAINEL';
            }
        }

        // ============================================
        // PAINEL ADMIN
        // ============================================
        function abrirAdmin() {
            document.getElementById('adminPanel').style.display = 'block';
            carregarAdmin();
        }

        function fecharAdmin() {
            document.getElementById('adminPanel').style.display = 'none';
            carregarCardapio();
        }

        function logout() {
            fecharAdmin();
            fecharModal();
        }

        async function carregarAdmin() {
            await carregarEstatisticas();
            carregarItensAdmin();
        }

        async function carregarEstatisticas() {
            try {
                const response = await fetch(`${API_URL}/api/admin/estatisticas`);
                const result = await response.json();
                
                if (result.success) {
                    let statsHtml = '';
                    result.data.forEach(stat => {
                        statsHtml += `
                            <div class="stat-card">
                                <h3>${stat.categoria}</h3>
                                <div class="stat-number">${stat.total}</div>
                            </div>
                        `;
                    });
                    document.getElementById('statsContainer').innerHTML = statsHtml;
                }
            } catch (error) {
                console.error('Erro ao carregar estat√≠sticas:', error);
            }
        }

        async function carregarItensAdmin() {
            try {
                const response = await fetch(`${API_URL}/api/cardapio`);
                const result = await response.json();
                
                if (result.success) {
                    let todosItens = [];
                    result.data.forEach(categoria => {
                        if (categoria.itens) {
                            categoria.itens.forEach(item => {
                                todosItens.push({
                                    ...item,
                                    categoria_id: categoria.id,
                                    categoria_nome: categoria.nome
                                });
                            });
                        }
                    });
                    
                    if (adminFiltro !== 'todos') {
                        todosItens = todosItens.filter(item => item.categoria_id == adminFiltro);
                    }
                    
                    renderizarItensAdmin(todosItens);
                }
            } catch (error) {
                console.error('Erro ao carregar itens:', error);
            }
        }

        function renderizarItensAdmin(itens) {
            let html = '';
            
            if (itens.length === 0) {
                html = '<div style="grid-column: 1/-1; text-align: center; padding: 60px; background: #f9f9f9; border-radius: 30px;">üì≠ Nenhum item encontrado</div>';
            } else {
                itens.forEach(item => {
                    html += `
                        <div class="admin-item">
                            ${item.foto ? 
                                `<img src="${item.foto}" class="admin-item-foto">` : 
                                `<div style="width:100px;height:100px;border-radius:50%;background:#f0f0f0;display:flex;align-items:center;justify-content:center;margin:0 auto 15px;border:3px solid var(--marrom);font-size:2rem;">ü•§</div>`
                            }
                            <h4 style="color: var(--marrom); text-align:center; margin-bottom:10px;">${item.nome}</h4>
                            <p style="color: #666; font-size:0.9rem; margin-bottom:10px;">${item.descricao.substring(0, 60)}...</p>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                                <span style="font-weight:800; color:var(--marrom);">R$ ${parseFloat(item.preco).toFixed(2)}</span>
                                <span style="background:#f0f0f0; padding:5px 15px; border-radius:20px;">${item.categoria_nome}</span>
                            </div>
                            ${item.badge ? `<span style="background:#f0f0f0; padding:5px 15px; border-radius:20px; display:inline-block; margin-bottom:15px;">${item.badge}</span>` : ''}
                            <div style="display: flex; gap: 10px;">
                                <button onclick="editarItem(${item.id})" class="btn" style="flex:2; padding:12px;">‚úèÔ∏è EDITAR</button>
                                <button onclick="deletarItem(${item.id})" class="btn btn-danger" style="flex:1; padding:12px;">üóëÔ∏è</button>
                            </div>
                        </div>
                    `;
                });
            }
            
            document.getElementById('adminItensList').innerHTML = html;
        }

        function filtrarAdmin(categoria) {
            adminFiltro = categoria;
            
            document.querySelectorAll('.filtro-btn').forEach(btn => {
                btn.classList.remove('ativo');
            });
            
            if (categoria === 'todos') {
                document.getElementById('filtroTodos').classList.add('ativo');
            } else {
                document.getElementById(`filtro${categoria}`).classList.add('ativo');
            }
            
            carregarItensAdmin();
        }

        // ============================================
        // ADICIONAR ITEM COM FOTO
        // ============================================
        async function adicionarItem() {
            const nome = document.getElementById('novoNome').value;
            const preco = document.getElementById('novoPreco').value;
            const descricao = document.getElementById('novaDescricao').value;
            
            if (!nome || !preco || !descricao) {
                alert('‚ùå Preencha todos os campos obrigat√≥rios!');
                return;
            }
            
            const fileInput = document.getElementById('fotoInput');
            let fotoUrl = null;
            let fotoNome = null;
            
            // Se tiver foto selecionada, fazer upload
            if (fileInput.files.length > 0) {
                const uploadResult = await fazerUploadFoto(fileInput.files[0]);
                if (uploadResult.success) {
                    fotoUrl = uploadResult.foto;
                    fotoNome = uploadResult.foto_nome;
                } else {
                    alert('‚ùå Erro ao fazer upload da foto: ' + uploadResult.message);
                    return;
                }
            }
            
            const item = {
                categoria_id: parseInt(document.getElementById('novaCategoria').value),
                nome: nome,
                descricao: descricao,
                preco: parseFloat(preco),
                badge: document.getElementById('novoBadge').value || null,
                destaque: document.getElementById('novoDestaque').checked,
                foto: fotoUrl,
                foto_nome: fotoNome
            };
            
            try {
                const response = await fetch(`${API_URL}/api/admin/itens`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(item)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('‚úÖ Item adicionado com sucesso!');
                    
                    // Limpar formul√°rio
                    document.getElementById('novoNome').value = '';
                    document.getElementById('novoPreco').value = '';
                    document.getElementById('novaDescricao').value = '';
                    document.getElementById('novoBadge').value = '';
                    document.getElementById('novoDestaque').checked = false;
                    document.getElementById('fotoInput').value = '';
                    document.getElementById('previewContainer').style.display = 'none';
                    
                    carregarAdmin();
                } else {
                    alert('‚ùå Erro: ' + result.message);
                }
            } catch (error) {
                console.error('Erro:', error);
                alert('‚ùå Erro ao adicionar: ' + error.message);
            }
        }

        // ============================================
        // EDITAR ITEM
        // ============================================
        async function editarItem(id) {
            const novoNome = prompt('Digite o novo nome do item:');
            if (!novoNome) return;
            
            const novoPreco = prompt('Digite o novo pre√ßo (ex: 29.90):');
            if (!novoPreco) return;
            
            const novaDescricao = prompt('Digite a nova descri√ß√£o:');
            if (!novaDescricao) return;
            
            try {
                const response = await fetch(`${API_URL}/api/admin/itens/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        nome: novoNome,
                        preco: parseFloat(novoPreco),
                        descricao: novaDescricao
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('‚úÖ Item atualizado com sucesso!');
                    carregarAdmin();
                } else {
                    alert('‚ùå Erro: ' + result.message);
                }
            } catch (error) {
                console.error('Erro:', error);
                alert('‚ùå Erro ao editar: ' + error.message);
            }
        }

        // ============================================
        // DELETAR ITEM
        // ============================================
        async function deletarItem(id) {
            if (!confirm('Tem certeza que deseja deletar este item?')) return;
            
            try {
                const response = await fetch(`${API_URL}/api/admin/itens/${id}`, {
                    method: 'DELETE'
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('üóëÔ∏è Item deletado com sucesso!');
                    carregarAdmin();
                } else {
                    alert('‚ùå Erro: ' + result.message);
                }
            } catch (error) {
                console.error('Erro:', error);
                alert('‚ùå Erro ao deletar: ' + error.message);
            }
        }

        // ============================================
        // LIMPAR CARD√ÅPIO
        // ============================================
        async function limparCardapio() {
            if (!confirm('‚ö†Ô∏è ATEN√á√ÉO! Isso vai apagar TODOS os itens do card√°pio!')) return;
            if (!confirm('CONFIRMA√á√ÉO FINAL: Deseja realmente limpar todo o card√°pio?')) return;
            
            try {
                const response = await fetch(`${API_URL}/api/cardapio`);
                const result = await response.json();
                
                let deletados = 0;
                
                for (const categoria of result.data) {
                    if (categoria.itens) {
                        for (const item of categoria.itens) {
                            await fetch(`${API_URL}/api/admin/itens/${item.id}`, {
                                method: 'DELETE'
                            });
                            deletados++;
                        }
                    }
                }
                
                alert(`‚úÖ ${deletados} itens removidos com sucesso!`);
                carregarAdmin();
                fecharAdmin();
                carregarCardapio();
            } catch (error) {
                console.error('Erro:', error);
                alert('‚ùå Erro ao limpar card√°pio: ' + error.message);
            }
        }

        // ============================================
        // INICIALIZAR
        // ============================================
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üöÄ Iniciando sistema com upload de fotos...');
            carregarCardapio();
            
            // Testar API
            fetch(`${API_URL}/api/test`)
                .then(res => res.json())
                .then(data => console.log('‚úÖ API conectada:', data))
                .catch(err => console.error('‚ùå API n√£o responde:', err));
        });
    </script>
</body>
</html>